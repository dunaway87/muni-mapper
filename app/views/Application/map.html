<!DOCTYPE html>
  
<html>
<head>
  <link rel ="stylesheet" href="public/stylesheets/main.css"/>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.9.1.js"></script>
  <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
  <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js?"></script>
 <link rel="stylesheet" href="/public/stylesheets/leaflet-0.7.1.css" />
    <script src="/public/javascripts/muni-mapper.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?2.1.3"></script>
    <script type="text/javascript" src="http://mbostock.github.com/d3/d3.geom.js?2.1.3"></script>
    <script type="text/javascript" src="http://mbostock.github.com/d3/d3.layout.js?2.1.3"></script>
        <script src="/public/javascripts/piecharts.js" type="text/javascript"></script>
            <script src="/public/javascripts/barcharts.js" type="text/javascript"></script>
  
 <script type="text/javascript">

 function folderClick(folderName){
	 	 $("#"+folderName+"UpArrow").toggle();
	 	 $("#"+folderName+"DownArrow").toggle();
	 	$("#"+folderName).toggle()
 }
$(document).ready(function (){
	$('#searchTab').click(function(){
		$('.searchContainer').slideToggle('fast');
		$('#layerGroupContainer').slideToggle('slow');
	});
$('#layersTab').click(function(){
	$('#layerGroupContainer').toggle();
});	
$.get("/getLayers").done(function(dataSTR){
	var data = jQuery.parseJSON(dataSTR);
 	console.log(data);
	var folderHtml ='';
 	for (var key in data) {
 		var folderName =key.replace(' ', '')+'Folder';
 			console.log(folderName);
 			folderHtml = folderHtml+'<li style="cursor:pointer" class="list-group-item" onClick="folderClick(\''+folderName+'\')">'+key+'<span id="'+folderName+'DownArrow" class="glyphicon glyphicon-chevron-down" style="float:right; display:none"></span><span id="'+folderName+'UpArrow" class="glyphicon glyphicon-chevron-up" style="float:right"></span></li><ul class="list-group" id="'+folderName+'" style="display:none; cursor:pointer">';
 			
 				
	 	  
	 	   var obj = data[key];
 	    for (var prop in obj) { 
			folderHtml = folderHtml+'<li id="'+obj[prop]+'"class="list-group-item" style = "margin-left:40px; cursor:pointer" onClick="manageLayer(\''+obj[prop]+'\')">'+obj[prop].replace(/_/g,' ')+'</li>';
 	      } 
 	    folderHtml = folderHtml+'</ul></li>';
 	   } 
 	
 	console.log(folderHtml);
 	$('#folderList').append(folderHtml);
	
	
$("#settingsTab").click(function(){
	$("#settingsList").slideToggle('fast');
	console.log($("#settingsTab").css( "background-color" ));
	if($("#settingsTab").css( "background-color" ) == "rgba(0, 0, 0, 0)" || $("#settingsTab").css( "background-color" ) == "rgb(16, 16, 16)"){
		$("#settingsTab").css("background-color", "#999");
		$("#settingsTab").css("color", "#101010");
	} else {
		$("#settingsTab").css("background-color", "#101010");
		$("#settingsTab").css("color", "#999");
	}
});


	$("#sataliteListItem").click(function(){
		$("#sataliteListItem").addClass("baseMapItemClicked");
		$("#terrainListItem").removeClass("baseMapItemClicked");
		addBaseMap('dunaway87.hffcoej7');
	});
	$("#terrainListItem").click(function(){
		$("#terrainListItem").addClass("baseMapItemClicked");
		$("#sataliteListItem").removeClass("baseMapItemClicked");
		addBaseMap('dunaway87.hff94j6p');
	});
	
	$("#clearAllLayersListItem").click(function(){
		console.log(layers);
		var length = layers.length;
		for(var i=0; i < length; i++){
			console.log(layers[0].layer);
			manageLayer(layers[0].layerName);
		}
		layers = new Array();
	});
	
 });

});


</script>


</head>

<header>
	<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Anchorage Municipal Maps</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
       <li><a href="#" id ="layersTab">
            	<span id ="layersTabLabel">Layers</span>
            	<span class ="glyphicon glyphicon-picture"></span>
           </a>
         </li>
            <li class="divider"></li>
         <li><a href="#" id ="searchTab">
            	<span id = "searchTabLabel">Search</span>
            	<span class = "glyphicon glyphicon-search"></span>
           </a>
      	 </li>
            <li class ="divider"></li>
            <li><a id="settingsTab">
           		 <span id ="settingsTabLabel">Settings</span>
            	 <span class="glyphicon glyphicon-cog"></span></a>
            </li>
           	 
            	
           <li class ="divider"></li>
          </ul>
        </div>
      </div>
    </div>
</header>
<body>
<div id="settingsList">



<ul class="nav nav-list">
  <li class="active" id="baseMapList">
 	<a href="#"> Base Map</a>
 	<li id="sataliteListItem" class="baseMapListItem">Satalite</li>
 	<li id="terrainListItem" class="baseMapListItem">Terrain</li>
 		
 </li>
  <li id="clearAllLayersListItem"><a href="#"> Clear All Layers</a></li>

</ul>

</div>
<div id ="wrapper">
<div id ="container" class="container-fluid">
  <div id = "layerGroupContainer">
   <ul class="list-group" id="folderList">


	</ul>
         
    </div>
    <div id= "map">
        <script type='text/javascript'>
       loadMap();
        </script>
    	<div id="legendsBox">   
   		 	<div id="legendsHeader">
      		 	<b>Legend</b> 
      		 	<span id="legendsDownArrow" class="glyphicon glyphicon-chevron-down" style="float: right; padding:5px"></span>
      		 	<span id="legendsUpArrow" class="glyphicon glyphicon-chevron-up" style="float: right; padding:5px; display:none"></span>
     		</div>
    		<div id="legends">
    			
    		</div>    
    	</div>
    <div class = "searchContainer" id = "searchResults">
   	</div>
<form role ="form"> 
	<div class ="form-group">  	
   		<div class="searchContainer" id ="searchBar">
   			<label for="addressSearch">Address Search</label>
   			<input type="text"  class ="form-control" id="address" placeholder="address"/>
	   		<button id="addressSearchButton" type="submit" class = "btn btn-default">search</button>
  		
  		
   	   <label for="nameSearch">Parcel Owner Search</label>
   		<input type="text"  class ="form-control" id="firstName" placeholder="First Name"/>
   		<input type="text" class = "form-control" id="lastName" placeholder="Last Name"/>
	   	<button id="nameSearchButton" class = "btn btn-default" type="submit">search</button>
	 </div>
  	</div>
 </form>  	
    </div>
    </div>
  </div>


        <script src="/public/javascripts/mapClicks.js" type="text/javascript"></script>

<script type="text/javascript">
$('#legendsHeader').click(function(){
	$('#legends').toggle();
	$('#legendsDownArrow').toggle();
	$('#legendsUpArrow').toggle();
	
});

</script>
</body>
</html>